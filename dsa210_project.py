# -*- coding: utf-8 -*-
"""DSA210_Project.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Oyywq-TnlfEKfDzc4DKmbIy7uayCT8-j
"""

import pandas as pd

months = ["Ocak", "Åubat", "Mart", "Nisan", "MayÄ±s", "Haziran",
          "Temmuz", "AÄŸustos", "EylÃ¼l", "Ekim", "KasÄ±m", "AralÄ±k"]
years = [2019, 2020, 2021, 2022, 2023, 2024]

# AylÄ±k doluluk oranlarÄ±
monthly_doluluk = {
    2019: [80.2, 81.4, 82.1, 82.6, 83.0, 83.4, 84.0, 83.7, 82.5, 81.9, 80.8, 80.0],
    2020: [79.5, 78.0, 65.2, 25.3, 30.1, 40.0, 55.6, 58.2, 60.4, 63.1, 64.2, 65.1],
    2021: [66.3, 67.1, 67.4, 67.8, 68.2, 68.5, 69.0, 70.1, 71.0, 72.2, 72.5, 73.0],
    2022: [78.0, 79.0, 80.5, 81.0, 81.6, 82.2, 83.1, 83.5, 83.0, 82.4, 81.3, 80.8],
    2023: [81.1, 81.5, 82.2, 82.7, 83.3, 84.1, 85.0, 84.8, 83.7, 83.1, 82.4, 81.9],
    2024: [82.0, 82.5, 83.0, 83.3, 83.7, 84.0, 85.2, 85.4, 84.3, 83.6, 82.9, 82.1]
}

# AylÄ±k yolcu sayÄ±larÄ± (milyon cinsinden)
monthly_passengers = {
    2019: [6.2, 6.4, 6.6, 6.7, 6.8, 6.9, 7.1, 7.0, 6.8, 6.5, 6.3, 6.0],
    2020: [5.5, 5.2, 1.2, 0.4, 0.6, 1.0, 1.5, 1.7, 1.9, 2.1, 2.3, 2.5],
    2021: [2.8, 3.2, 3.6, 4.0, 4.3, 4.6, 5.1, 5.5, 5.8, 6.0, 6.2, 6.4],
    2022: [6.6, 6.8, 7.0, 7.2, 7.4, 7.5, 7.6, 7.7, 7.8, 7.9, 8.0, 8.1],
    2023: [8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9, 9.0, 9.1, 9.2],
    2024: [9.3, 9.4, 9.5, 9.6, 9.7, 9.8, 9.9, 10.0, 10.1, 10.2, 10.3, 10.4]
}

# Yaz tatili (Haziran, Temmuz, AÄŸustos = 1)
yaz_tatil_matrisi = {
    year: [1 if i in [5, 6, 7] else 0 for i in range(12)] for year in years
}

# Tatil gÃ¼n sayÄ±sÄ±
tatil_gunleri_dogru = {
    2019: [1, 0, 0, 2, 3, 4, 0, 1, 0, 2, 1, 1],
    2020: [1, 0, 0, 2, 4, 3, 1, 2, 1, 1, 1, 1],
    2021: [1, 0, 0, 1, 4, 5, 0, 1, 0, 2, 1, 1],
    2022: [1, 0, 0, 2, 3, 5, 0, 1, 0, 2, 1, 1],
    2023: [1, 0, 0, 2, 4, 4, 0, 1, 0, 2, 1, 1],
    2024: [1, 0, 0, 1, 4, 5, 0, 1, 0, 2, 1, 1]
}

# Enflasyon ve yakÄ±t
enflasyon = {
    2019: [1.06, 0.16, 1.03, 1.69, 0.95, 0.03, 1.36, 0.86, 0.99, 2.00, 0.38, 0.74],
    2020: [1.35, 0.35, 0.57, 0.85, 1.36, 1.13, 0.58, 0.86, 0.97, 2.13, 2.30, 1.25],
    2021: [1.68, 0.91, 1.08, 1.68, 0.89, 1.94, 1.80, 1.12, 1.25, 2.39, 3.51, 13.58],
    2022: [11.10, 4.81, 5.46, 7.25, 2.98, 4.95, 2.37, 1.46, 3.08, 3.54, 2.88, 1.18],
    2023: [6.65, 3.15, 2.29, 2.39, 0.04, 3.92, 9.49, 9.09, 4.75, 3.43, 3.28, 2.93],
    2024: [6.70, 4.53, 3.16, 3.18, 3.37, 1.64, 1.36, 1.46, 4.75, 3.43, 3.28, 2.93]
}

yakÄ±t = {
    2019: [1.15, 1.12, 1.10, 1.08, 1.09, 1.11, 1.13, 1.14, 1.16, 1.18, 1.20, 1.22],
    2020: [1.23, 1.25, 1.20, 1.10, 1.05, 1.08, 1.12, 1.15, 1.17, 1.19, 1.21, 1.24],
    2021: [1.26, 1.28, 1.30, 1.32, 1.34, 1.36, 1.38, 1.40, 1.42, 1.44, 1.46, 1.48],
    2022: [1.50, 1.52, 1.54, 1.56, 1.58, 1.60, 1.62, 1.64, 1.66, 1.68, 1.70, 1.72],
    2023: [1.74, 1.76, 1.78, 1.80, 1.82, 1.84, 1.86, 1.88, 1.90, 1.92, 1.94, 1.96],
    2024: [1.98, 2.00, 2.02, 2.04, 2.06, 2.08, 2.10, 2.12, 2.14, 2.16, 2.18, 2.20]
}

# AylÄ±k COVID-19 vaka sayÄ±larÄ± (bin kiÅŸi olarak varsayÄ±lmÄ±ÅŸtÄ±r)
covid_vaka = {
    2019: [0]*12,
    2020: [0, 0, 3, 65, 145, 120, 95, 80, 70, 60, 50, 45],
    2021: [40, 60, 95, 100, 110, 85, 70, 65, 75, 90, 120, 140],
    2022: [180, 160, 140, 100, 85, 60, 40, 30, 20, 15, 10, 5],
    2023: [5, 5, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1],
    2024: [0]*12
}

# TÃ¼m verileri birleÅŸtir
data = {
    "YÄ±l": [], "Ay": [], "Tarih": [], "Doluluk OranÄ± (%)": [],
    "Yolcu SayÄ±sÄ± (Milyon)": [], "Yaz Tatili mi? (1=Evet)": [],
    "Tatil GÃ¼n SayÄ±sÄ±": [], "Enflasyon (%)": [], "YakÄ±t FiyatÄ± (USD/Litre)": [],
    "COVID Vaka SayÄ±sÄ± (Bin)": []
}

for year in years:
    for i, month in enumerate(months):
        data["YÄ±l"].append(year)
        data["Ay"].append(month)
        data["Tarih"].append(pd.to_datetime(f"{year}-{i+1}-01"))
        data["Doluluk OranÄ± (%)"].append(monthly_doluluk[year][i])
        data["Yolcu SayÄ±sÄ± (Milyon)"].append(monthly_passengers[year][i])
        data["Yaz Tatili mi? (1=Evet)"].append(yaz_tatil_matrisi[year][i])
        data["Tatil GÃ¼n SayÄ±sÄ±"].append(tatil_gunleri_dogru[year][i])
        data["Enflasyon (%)"].append(enflasyon[year][i])
        data["YakÄ±t FiyatÄ± (USD/Litre)"].append(yakÄ±t[year][i])
        data["COVID Vaka SayÄ±sÄ± (Bin)"].append(covid_vaka[year][i])

df = pd.DataFrame(data)

# Kontrol iÃ§in ilk 5 satÄ±r
print(df.head())

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Ay sÄ±ralamasÄ± iÃ§in
df["Ay"] = pd.Categorical(df["Ay"], categories=[
    "Ocak", "Åubat", "Mart", "Nisan", "MayÄ±s", "Haziran",
    "Temmuz", "AÄŸustos", "EylÃ¼l", "Ekim", "KasÄ±m", "AralÄ±k"
], ordered=True)

sns.set(style="whitegrid")
plt.rcParams["figure.figsize"] = (12, 6)

# 1. Doluluk OranÄ± Zaman Serisi (YÄ±llar ve Aylara GÃ¶re)
plt.figure()
sns.lineplot(data=df, x="Ay", y="Doluluk OranÄ± (%)", hue="YÄ±l", marker="o")
plt.title("AylÄ±k Doluluk OranÄ± Zaman Serisi (2019â€“2024)")
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()

# 2. Yolcu SayÄ±sÄ± Zaman Serisi
plt.figure()
sns.lineplot(data=df, x="Tarih", y="Yolcu SayÄ±sÄ± (Milyon)", hue="YÄ±l", palette="tab10")
plt.title("Zaman Ä°Ã§inde Yolcu SayÄ±sÄ± (Milyon)")
plt.tight_layout()
plt.show()

# 3. Doluluk OranÄ± ve Yaz Tatili Ä°liÅŸkisi
plt.figure()
sns.boxplot(data=df, x="Yaz Tatili mi? (1=Evet)", y="Doluluk OranÄ± (%)")
plt.xticks([0, 1], ["HayÄ±r", "Evet"])
plt.title("Yaz Tatilinde Doluluk OranÄ± DaÄŸÄ±lÄ±mÄ±")
plt.tight_layout()
plt.show()

# 4. Doluluk OranÄ± vs Enflasyon
plt.figure()
sns.scatterplot(data=df, x="Enflasyon (%)", y="Doluluk OranÄ± (%)", hue="YÄ±l", palette="coolwarm", s=70)
sns.regplot(data=df, x="Enflasyon (%)", y="Doluluk OranÄ± (%)", scatter=False, color="black")
plt.title("Doluluk OranÄ± vs Enflasyon")
plt.tight_layout()
plt.show()

# 5. Doluluk OranÄ± vs YakÄ±t FiyatÄ±
plt.figure()
sns.scatterplot(data=df, x="YakÄ±t FiyatÄ± (USD/Litre)", y="Doluluk OranÄ± (%)", hue="YÄ±l", palette="viridis", s=70)
sns.regplot(data=df, x="YakÄ±t FiyatÄ± (USD/Litre)", y="Doluluk OranÄ± (%)", scatter=False, color="black")
plt.title("Doluluk OranÄ± vs YakÄ±t FiyatÄ±")
plt.tight_layout()
plt.show()

# 6. AylÄ±k Ortalama Yolcu SayÄ±sÄ±
plt.figure()
sns.boxplot(data=df, x="Ay", y="Yolcu SayÄ±sÄ± (Milyon)")
plt.title("AylÄ±k Yolcu SayÄ±sÄ± DaÄŸÄ±lÄ±mÄ±")
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()

# 7. Korelasyon IsÄ± HaritasÄ± (COVID dahil)
plt.figure(figsize=(10, 6))
corr = df[["Doluluk OranÄ± (%)", "Yolcu SayÄ±sÄ± (Milyon)", "Enflasyon (%)",
           "YakÄ±t FiyatÄ± (USD/Litre)", "Tatil GÃ¼n SayÄ±sÄ±", "COVID Vaka SayÄ±sÄ± (Bin)"]].corr()
sns.heatmap(corr, annot=True, cmap="coolwarm", fmt=".2f")
plt.title("DeÄŸiÅŸkenler ArasÄ± Korelasyon Matrisi (COVID Dahil)")
plt.tight_layout()
plt.show()

# --- YENÄ°: COVID ile iliÅŸkili analizler ---

# 8. COVID Vaka SayÄ±sÄ± Zaman Serisi
plt.figure()
sns.lineplot(data=df, x="Tarih", y="COVID Vaka SayÄ±sÄ± (Bin)", hue="YÄ±l", palette="rocket", marker="o")
plt.title("Zaman Ä°Ã§inde AylÄ±k COVID Vaka SayÄ±sÄ± (Bin)")
plt.tight_layout()
plt.show()

# 9. COVID Vaka SayÄ±sÄ± vs Doluluk OranÄ±
plt.figure()
sns.scatterplot(data=df, x="COVID Vaka SayÄ±sÄ± (Bin)", y="Doluluk OranÄ± (%)", hue="YÄ±l", palette="mako", s=70)
sns.regplot(data=df, x="COVID Vaka SayÄ±sÄ± (Bin)", y="Doluluk OranÄ± (%)", scatter=False, color="black")
plt.title("COVID Vaka SayÄ±sÄ± vs Doluluk OranÄ±")
plt.tight_layout()
plt.show()

# 10. COVID Vaka SayÄ±sÄ± vs Yolcu SayÄ±sÄ±
plt.figure()
sns.scatterplot(data=df, x="COVID Vaka SayÄ±sÄ± (Bin)", y="Yolcu SayÄ±sÄ± (Milyon)", hue="YÄ±l", palette="crest", s=70)
sns.regplot(data=df, x="COVID Vaka SayÄ±sÄ± (Bin)", y="Yolcu SayÄ±sÄ± (Milyon)", scatter=False, color="black")
plt.title("COVID Vaka SayÄ±sÄ± vs Yolcu SayÄ±sÄ±")
plt.tight_layout()
plt.show()

from scipy.stats import ttest_ind

# COVID Ã¶ncesi (2019)
pre_covid = df[df["YÄ±l"] == 2019]
# COVID dÃ¶nemi (2020 ve 2021)
during_covid = df[df["YÄ±l"].isin([2020, 2021])]

# 1. Doluluk OranÄ± karÅŸÄ±laÅŸtÄ±rmasÄ±
t_stat1, p_val1 = ttest_ind(pre_covid["Doluluk OranÄ± (%)"], during_covid["Doluluk OranÄ± (%)"], alternative="greater")

print("ğŸ§ª Hipotez Testi 1: Doluluk OranÄ±")
print(f"T-istatistiÄŸi: {t_stat1:.3f}, P-deÄŸeri: {p_val1:.3f}")
if p_val1 < 0.05:
    print("ğŸ”´ Hâ‚€ reddedildi: COVID dÃ¶neminde doluluk oranÄ± anlamlÄ± ÅŸekilde DÃœÅÃœK.")
else:
    print("ğŸŸ¢ Hâ‚€ reddedilemedi: COVID etkisi anlamlÄ± deÄŸil gibi gÃ¶rÃ¼nÃ¼yor.")

# 2. Yolcu SayÄ±sÄ± karÅŸÄ±laÅŸtÄ±rmasÄ±
t_stat2, p_val2 = ttest_ind(pre_covid["Yolcu SayÄ±sÄ± (Milyon)"], during_covid["Yolcu SayÄ±sÄ± (Milyon)"], alternative="greater")

print("\nğŸ§ª Hipotez Testi 2: Yolcu SayÄ±sÄ±")
print(f"T-istatistiÄŸi: {t_stat2:.3f}, P-deÄŸeri: {p_val2:.3f}")
if p_val2 < 0.05:
    print("ğŸ”´ Hâ‚€ reddedildi: COVID dÃ¶neminde yolcu sayÄ±sÄ± anlamlÄ± ÅŸekilde AZ.")
else:
    print("ğŸŸ¢ Hâ‚€ reddedilemedi: Yolcu sayÄ±sÄ±nda anlamlÄ± fark yok gibi.")

import pandas as pd
from scipy.stats import ttest_ind, pearsonr

# Yaz tatili gruplarÄ±
tatil_var = df[df["Yaz Tatili mi? (1=Evet)"] == 1]
tatil_yok = df[df["Yaz Tatili mi? (1=Evet)"] == 0]

# Tatil gÃ¼nÃ¼ sayÄ±sÄ± gruplarÄ±: 0â€“1 az, 2+ Ã§ok
df["Tatil GÃ¼nÃ¼ Grubu"] = df["Tatil GÃ¼n SayÄ±sÄ±"].apply(lambda x: "Az" if x <= 1 else "Fazla")
tatil_az = df[df["Tatil GÃ¼nÃ¼ Grubu"] == "Az"]
tatil_fazla = df[df["Tatil GÃ¼nÃ¼ Grubu"] == "Fazla"]

# Pre ve Post gruplarÄ±
pre_covid = df[df["YÄ±l"] == 2019]
post_covid = df[df["YÄ±l"].isin([2022, 2023, 2024])]

### T-TESTLER ###
def ttest_print(grup1, grup2, degisken, label1, label2):
    tstat, pval = ttest_ind(grup1[degisken], grup2[degisken])
    print(f"\nğŸ§ª {degisken} iÃ§in {label1} vs {label2}")
    print(f"T-istatistiÄŸi = {tstat:.3f}, P-deÄŸeri = {pval:.4f}")
    if pval < 0.05:
        print("ğŸ”´ AnlamlÄ± fark VAR.")
    else:
        print("ğŸŸ¢ AnlamlÄ± fark YOK.")

# 1: YakÄ±t FiyatÄ± (Pre vs Post)
ttest_print(pre_covid, post_covid, "YakÄ±t FiyatÄ± (USD/Litre)", "Pre", "Post")

# 2: Enflasyon (Pre vs Post)
ttest_print(pre_covid, post_covid, "Enflasyon (%)", "Pre", "Post")

# 3: Doluluk OranÄ± (Yaz tatili var mÄ±)
ttest_print(tatil_var, tatil_yok, "Doluluk OranÄ± (%)", "Tatil Var", "Tatil Yok")

# 4: Yolcu SayÄ±sÄ± (Tatil gÃ¼nÃ¼ az vs Ã§ok)
ttest_print(tatil_az, tatil_fazla, "Yolcu SayÄ±sÄ± (Milyon)", "Tatil Az", "Tatil Fazla")


### KORELASYONLAR ###
def corr_print(x, y, label_x, label_y):
    r, p = pearsonr(df[x], df[y])
    print(f"\nğŸ“ˆ Pearson Korelasyonu: {label_x} â†” {label_y}")
    print(f"r = {r:.3f}, p = {p:.4f}")
    if p < 0.05:
        print("ğŸ”´ AnlamlÄ± korelasyon VAR.")
    else:
        print("ğŸŸ¢ AnlamlÄ± korelasyon YOK.")

# A: YakÄ±t vs Enflasyon
corr_print("YakÄ±t FiyatÄ± (USD/Litre)", "Enflasyon (%)", "YakÄ±t", "Enflasyon")

# B: Enflasyon vs Doluluk
corr_print("Enflasyon (%)", "Doluluk OranÄ± (%)", "Enflasyon", "Doluluk")

# C: YakÄ±t vs Doluluk
corr_print("YakÄ±t FiyatÄ± (USD/Litre)", "Doluluk OranÄ± (%)", "YakÄ±t", "Doluluk")